var app=function(a,e){var c=function(){};c.version="1.6.1";c.welcomeVer="1.6.1";c.serialNumber="6.6.19 9:38";c.appType=3;c.debug=!1;c.upFile="_doc/update/tm.wgt";c.appFile="_doc/update/tm.apk";c.webHost="http://m.chorse-sports.com/";c.log=function(b){c.debug&&console.log(b)};c.defaultToken="zmgjapp";c.isStatusbarOffset=!1;c.getUrl=function(b){if(1==c.appType)return"http://192.168.1.202:8100/"+b;if(2==c.appType)return"http://testapi.chorse-sports.com/"+b;if(3==c.appType)return"http://api.chorse-sports.com/"+b};c.method={user_login:"api/user/login",user_register:"api/user/login/regist",user_UpdateUserBase:"api/user/UpdateUserBase"};c.reg={password:/^(\w){6,18}$/};c.getQueryString=function(b){b=new RegExp("(^|\x26)"+b+"\x3d([^\x26]*)(\x26|$)","i");b=window.location.search.substr(1).match(b);return null!=b?unescape(b[2]):null};c.createNonceStr=function(){return Math.random().toString(36).substr(2,15)};c.createTimestamp=function(){return parseInt((new Date).getTime()/1E3)+""};c.getSN=function(){return c.Cache.get(c.Cache.key.sn.toKeyName(),function(){return Math.random().toString(36).substr(2,10)})};c.checkLogin=function(b){c.User.getToken()&&c.User.getToken()!=c.defaultToken?b():(c.Cache.sset(c.Cache.key.returnurl.toKeyName(),location.href),(b=c.getQueryString("refOpenId"))&&c.Cache.set(c.Cache.key.referrer.toKeyName(),b),history.replaceState(null,"","../login/login.html"),location.reload())};c.zeros=function(b,a){var f="000000000000"+b;return f.substr(f.length-a)};c.os=function(){var b=navigator.userAgent.toLowerCase();return{weixin:"micromessenger"==b.match(/MicroMessenger/i),mobile:!!b.match(/AppleWebKit.*Mobile.*/)}}();c.toUtf8=function(b){var a,d,c,e;a="";c=b.length;for(d=0;d<c;d++)e=b.charCodeAt(d),1<=e&&127>=e?a+=b.charAt(d):(2047<e?(a+=String.fromCharCode(224|e>>12&15),a+=String.fromCharCode(128|e>>6&63)):a+=String.fromCharCode(192|e>>6&31),a+=String.fromCharCode(128|e>>0&63));return a};c.getTime=function(b){b=parseInt(b);var a=0,d=0,c=0;60<b&&(a=parseInt(b/60),b=parseInt(b%60),60<a&&(d=parseInt(a/60),a=parseInt(a%60),24<d&&(c=parseInt(d/24),d=parseInt(d%24))));0<a&&(b=a+":"+b);0<d&&(b=d+":"+b);0<c&&(b=c+"\u5929"+b);return b};c.isInstalled=function(b){if("qihoo"===b&&mui.os.plus)return!0;if(mui.os.android){var a=plus.android.runtimeMainActivity().getPackageManager(),c=plus.android.importClass(a),e={qq:"com.tencent.mobileqq",weixin:"com.tencent.mm",sinaweibo:"com.sina.weibo"};try{return a.getPackageInfo(e[b],c.GET_ACTIVITIES)}catch(h){}}else switch(b){case "qq":return plus.ios["import"]("TencentOAuth").iphoneQQInstalled();case "weixin":return plus.ios["import"]("WXApi").isWXAppInstalled();case "sinaweibo":return plus.ios["import"]("WeiboSDK").isWeiboAppInstalled()}};"function"===typeof define&&define.amd&&define("app",[],function(){return c});return c}(document);(function(a){String.prototype.toKeyName===a&&(String.prototype.toKeyName=function(){for(var a=this+"_",c=0;c<arguments.length;c++)a+=arguments[c]+"_";return a},String.prototype.Format=function(a){var c=new Date(this),b={"M+":c.getMonth()+1,"d+":c.getDate(),"h+":c.getHours(),"m+":c.getMinutes(),"s+":c.getSeconds(),"q+":Math.floor((c.getMonth()+3)/3),S:c.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(c.getFullYear()+"").substr(4-RegExp.$1.length)));for(var f in b)(new RegExp("("+f+")")).test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?b[f]:("00"+b[f]).substr((""+b[f]).length)));return a.replace("T"," ").replace("+08:00","")},Date.prototype.Format=function(a){var c={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var b in c)(new RegExp("("+b+")")).test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?c[b]:("00"+c[b]).substr((""+c[b]).length)));return a.replace("T"," ").replace("+08:00","").replace(/-/g,"/")});Object.setPrototypeOf=Object.setPrototypeOf||function(a,c){a.__proto__=c;return a}})();(function(a,e){var c=require("mui");e.indexedDB=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB;e.IDBTransaction=e.IDBTransaction||e.webkitIDBTransaction||e.msIDBTransaction;e.IDBKeyRange=e.IDBKeyRange||e.webkitIDBKeyRange||e.msIDBKeyRange;a.Cache={keyTime:"keyTime",key:{version:"version",upFileVer:"upFileVer",user:"user",sn:"sn",token:"token",userID:"userID",returnurl:"returnurl",cpageTitle:"cpageTitle",cpageUrl:"cpageUrl",isUpFile:"isUpFile",isRestartOpen:"isRestartOpen",selectWelcome:"selectWelcome",cindexData:"cindexData",cnewsData:"cnewsData",cclubData:"cclubData",cequestrianData:"cequestrianData",chooseFromPage:"chooseFromPage",chooseFromPageID:"chooseFromPageID",choosedClub:"choosedClub",choosedClubIsParent:"choosedClubIsParent",cOrderNo:"cOrderNo",clubData:"clubData",chapterData:"chapterData",cOrderMoney:"cOrderMoney",headPhoto:"headPhoto",userPhoto1:"userPhoto1",userPhoto2:"userPhoto2",selectAddr:"selectAddr",wxService:"wxService"},init:function(){a.Cache.del(a.Cache.key.caskNewsId.toKeyName())},get:function(b,f,c){var d=localStorage.getItem(a.Cache.keyTime.toKeyName(b)),d=null==d?0:parseInt(d),e=(new Date).getTime();0!=d&&d<e&&localStorage.removeItem(b);void 0!=c&&localStorage.setItem(a.Cache.keyTime.toKeyName(b),e+1E3*c);c=localStorage.getItem(b);null==c&&void 0!=f&&(c=f(),localStorage.setItem(b,c));return c},getInt:function(b,c,d){b=a.Cache.get(b,c,d);return null==b?0:parseInt(b)},set:function(b,c,d){localStorage.setItem(b,c);void 0!=d&&(c=(new Date).getTime(),localStorage.setItem(a.Cache.keyTime.toKeyName(b),c+1E3*d))},setObject:function(b,c,d){localStorage.setItem(b,JSON.stringify(c));void 0!=d&&(c=(new Date).getTime(),localStorage.setItem(a.Cache.keyTime.toKeyName(b),c+1E3*d))},getFloat:function(b,c,d){b=a.Cache.get(b,c,d);return null==b?0:parseFloat(b)},getBoolean:function(b,c,d){return"true"==a.Cache.get(b,c,d)?!0:!1},getObject:function(b,c,d){b=a.Cache.get(b,c,d);return null==b?null:JSON.parse(b)},getArray:function(b,c,d){b=a.Cache.get(b,c,d);return null==b?[]:JSON.parse(b)},getString:function(b,c,d){b=a.Cache.get(b,c,d);return null==b?"":b.toString()},del:function(b){localStorage.removeItem(b);localStorage.removeItem(a.Cache.keyTime.toKeyName(b))},iHasKey:function(b){b=a.Cache.keyTime.toKeyName(b);return localStorage.hasOwnProperty(b)},sset:function(b,a){sessionStorage.setItem(b,a)},sget:function(b){return sessionStorage.getItem(b)},sgetInt:function(b){b=a.Cache.sget(b);return isNaN(b)?0:parseInt(b)},ssetObject:function(b,a){sessionStorage.setItem(b,JSON.stringify(a))},sgetObject:function(b){b=a.Cache.sget(b);return null==b?null:JSON.parse(b)},version:1,objectStoreName:"db",instance:{},upgrade:function(b){b=b.target.result;var c=a.Cache.objectStoreName;b.objectStoreNames.contains(c)||b.createObjectStore(c,{keyPath:"key",autoIncrement:!0})},errorHandler:function(b){},open:function(b){var c=e.indexedDB.open(a.Cache.objectStoreName,a.Cache.version);c.onerror=a.Cache.errorHandler;c.onupgradeneeded=a.Cache.upgrade;c.onsuccess=function(d){a.Cache.instance=c.result;a.Cache.instance.onerror=a.Cache.errorHandler;b()}},getObjectStore:function(b){return a.Cache.instance.transaction([a.Cache.objectStoreName],b||"readonly").objectStore(a.Cache.objectStoreName)},iset:function(b,f,d,e){d=d||864E3;var g=(new Date).getTime();b=a.Cache.keyTime.toKeyName(b);a.Cache.set(b,g+1E3*d);if(c.os.plus)"object"==typeof f&&(f=JSON.stringify(f)),plus.storage.setItem(b,f);else try{a.Cache.open(function(){var c,d={key:b,val:f};c=a.Cache.getObjectStore("readwrite");(b?c.put(d):c.add(d)).onsuccess=e})}catch(k){}},iget:function(b,f){b=a.Cache.keyTime.toKeyName(b);try{c.os.plus?f(plus.storage.getItem(b)):a.Cache.open(function(){a.Cache.getObjectStore("readwrite").get(b).onsuccess=function(b){f(result?result.val:null)}})}catch(d){f(null)}},igetObject:function(b,f){b=a.Cache.keyTime.toKeyName(b);try{if(c.os.plus){var d=plus.storage.getItem(b);f(d&&JSON.parse(d))}else a.Cache.open(function(){a.Cache.getObjectStore("readwrite").get(b).onsuccess=function(b){f(b.target.result?b.target.result.val:null)}})}catch(g){f(null)}},igetAll:function(b){a.Cache.open(function(){var c=[];a.Cache.getObjectStore().openCursor().onsuccess=function(a){(a=a.target.result)&&null!==a?(c.push(a.value),a["continue"]()):b(c)}})},idelete:function(b,c){a.Cache.open(function(){a.Cache.getObjectStore("readwrite")["delete"](b).onsuccess=c})},ideleteAll:function(b){for(var f=[],d=0;0<=d;d++){var e=localStorage.key(d);e?0==e.indexOf(a.Cache.keyTime.toKeyName())&&f.push(e):d=-2}for(d=0;d<f.length;d++)e=f[d],a.Cache.del(e);c.os.plus?(plus.storage.clear(),b&&b()):a.Cache.open(function(){var c;c=a.Cache.getObjectStore("readwrite").clear();b&&(c.onsuccess=b)})},iclearExpired:function(){for(var b=[],f=0;0<=f;f++){var d=localStorage.key(f);d?0==d.indexOf(a.Cache.keyTime.toKeyName())&&b.push(d):f=-2}for(f=0;f<b.length;f++){var d=b[f],e=a.Cache.getInt(d),h=(new Date).getTime();0!=e&&e<h&&(a.Cache.del(d),c.os.plus?plus.storage.removeItem(d):a.Cache.idelete(d))}}};a.User={showName:"",loginName:"",token_type:"",UserID:"",NickName:"",MobileNum:"",VTimes:"",ImgUrl:"",PersonSign:"",Points:"",Exp:"",MB:0,RiderNum:"",ChapterID:"",ChapterName:"",RealName:"",Sex:"",IDCard:"",RaderLevel:"",IsChapterMaster:"",LastDT:"",Token:"",BirthDT:"",ClubID:"",ClubName:"",MemberNo:"",IsMember:"",MemberCreateDT:"",ExpireDT:"",QRCode:"",IsChangClub:"",IsPayPwd:!0,ImgUrls:[],FNums:"",getShowName:function(b){return b.NickName&&0<b.NickName.length?b.NickName:b.RealName&&0<b.RealName.length?b.RealName:b.loginName&&0<b.loginName.length?b.loginName:""},set:function(b){a.User.setToken(b.Token);a.User.setUserID(b.UserID);b.showName=a.User.getShowName(b);a.Cache.setObject(a.Cache.key.user.toKeyName(),b)},get:function(){return a.Cache.getObject(a.Cache.key.user.toKeyName())||a.User},setToken:function(b){a.Cache.set(a.Cache.key.token.toKeyName(),b)},getToken:function(){return a.Cache.getString(a.Cache.key.token.toKeyName())},setUserID:function(b){a.Cache.set(a.Cache.key.userID.toKeyName(),b)},getUserID:function(){return a.Cache.getString(a.Cache.key.userID.toKeyName())},setAccessToken:function(b){a.Cache.set(a.Cache.key.access_token.toKeyName(),b)},getAccessToken:function(){return a.Cache.getString(a.Cache.key.access_token.toKeyName())},clear:function(){a.Cache.del(a.Cache.key.token.toKeyName());a.Cache.del(a.Cache.key.userID.toKeyName());a.Cache.del(a.Cache.key.user.toKeyName())}}})(app,window);(function(a,e,c){a.createLoading=(a.loading=e.getElementById("app_LOADING"),a.loading||(a.loading=e.createElement("div"),a.loading.id="app_LOADING",a.loading.className="mui-backdrop",a.loading.innerHTML='\x3cdiv class\x3d"con" \x3e\x3cdiv\x3e\x3ci class\x3d"mui-spinner"\x3e\x3c/i\x3e\x3c/div\x3e\x3c/div\x3e'),a.loading);a.showWaiting=function(b,c){a.createLoading.className=b?"mui-backdrop mui-backdrop-"+b:"mui-backdrop";e.body.appendChild(a.createLoading);var d=e.getElementById("app_LOADING");"1"==c?d.addEventListener("touchstart",function(b){b=b||window.event;b.preventDefault()}):d.addEventListener("doubletap",function(){a.closeWaiting()})};a.closeWaiting=function(){a.loading&&a.loading.parentNode&&a.loading.parentNode.removeChild(a.loading)};a.fExpect=function(){a.expectNew=e.getElementById("app_fExpect");a.expectNew?a.expectNew.style.display="":(a.expectNew=e.createElement("div"),a.expectNew.id="app_fExpect",a.expectNew.innerHTML='\x3cdiv style\x3d"position: fixed;z-index: 998;top: 0;right: 0;bottom: 0;left: 0;background-color: rgba(0, 0, 0, .4)"\x3e\t\x3cdiv style\x3d"width: 200px;margin: 200px auto;background: #fff; border-radius: 10px;text-align: center;padding: 10px;"\x3e\t\t\x3cdiv style\x3d"width: 80%;margin: 0 auto;"\x3e\t\t\t\x3cimg src\x3d"../../img/building.png" style\x3d"width: 100%" /\x3e\t\t\x3c/div\x3e\t\t\x3cdiv style\x3d"margin-top: 10px;font-size: 12px;"\x3e\u6a21\u5757\u5efa\u8bbe\u4e2d\uff0c\u656c\u8bf7\u671f\u5f85~~\x3c/div\x3e\t\x3c/div\x3e\x3c/div\x3e',a.expectNew.addEventListener("tap",function(){a.expectNew&&(a.expectNew.style.display="none")}),e.body.appendChild(a.expectNew));setTimeout(function(){a.expectNew&&(a.expectNew.style.display="none")},1E3)};a.showError=function(b,c){a.err=e.getElementById("app_Error");a.closeWaiting();a.err?a.err.style.display="":(a.err=e.createElement("div"),a.err.id="app_Error",a.err.className=c?"mui-backdrop-error mui-backdrop-error-"+c:"mui-backdrop-error",a.err.innerHTML='\x3cdiv style\x3d"width: 300px;margin:100px auto;text-align: center;"\x3e\x3cimg src\x3d"../../img/net_error.png" style\x3d"width: 60%;" /\x3e\x3cdiv style\x3d"margin-top: 25px;"\x3e\u7f51\u7edc\u4e0d\u7a33\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u5e76\u5237\u65b0\u91cd\u8bd5\x3c/div\x3e\x3cbutton type\x3d"button" class\x3d"mui-button-row mui-btn-yellow" style\x3d"margin-top: 50px;width: 100px;"\x3e\u91cd\u65b0\u52a0\u8f7d\x3c/button\x3e\x3c/div\x3e',a.err.addEventListener("tap",function(){a.closeError();b()}),e.body.appendChild(a.err))};a.closeError=function(){var b=e.getElementById("app_Error");b&&(b.style.display="none")};a.getElementPosition=function(b){var a={top:0,left:0};b=b.getBoundingClientRect&&b.getBoundingClientRect()||a;return{top:b.top+document.body.scrollTop,left:b.left+document.body.scrollLeft}};a.autoScroll=function(b){mui(b||"input").each(function(){this.addEventListener("focus",function(){var b=this,d=a.getElementPosition(b);setTimeout(function(){e.documentElement.clientHeight/2<d.top+3*b.offsetHeight&&(e.body.style.height=1.5*e.documentElement.clientHeight+"px",c.scrollTo(0,d.top-2*b.offsetHeight))},200)});this.addEventListener("blur",function(){e.body.style.height=""})})};a.toggleActive=function(b){var a,c;window.addEventListener(mui.EVENT_START,function(d){for(d=d.target;d&&d!==document;){if(d.classList){var e=d.classList;if(e.contains(b)){a&&(a.cancel(),c&&c.remove("mui-active"));c=e;c.add("mui-active");a=mui.later(function(){c.remove("mui-active")},100);break}}d=d.parentNode}})};a.loadImg=function(){setTimeout(function(){a.loadingImg();setTimeout(function(){a.loadingImg()},1E3)},200)};a.loadingImg=function(){var b=document.querySelectorAll("[data-img^\x3d'http']"),a=0,c=function(){var d=b[a];a++;var e=d.dataset.img;if(!e)return!0;var f=new Image;f.src=e;f.onload=function(f){"i"==d.localName?d.style.background="url("+e+")":"img"==d.localName&&(d.src=e);b.length>a&&c()};f.onerror=function(){b.length>a&&c()}};0<b.length&&c()};a.ellipsisToggle=function(){setTimeout(function(){a.ellipsisT();setTimeout(function(){a.ellipsisT()},1E3)},100)};a.ellipsisT=function(){for(var b=document.querySelectorAll(".y-ellipsis-flag"),a=0;a<b.length;a++){b[a].classList.remove("y-ellipsis-flag");var c=document.createElement("p");c.innerText=b[a].innerText;c.style.top="-2000px";c.style.position="absolute";c.width=b[a].offsetWidth;b[a].parentNode.appendChild(c);if(c.offsetHeight>b[a].clientHeight){var e=document.createElement("h6");e.innerText="\u5c55\u5f00";e.className="mui-text-right y-ellipsis-tag";e.addEventListener("tap",function(){var b=this.previousElementSibling;b.classList.contains("y-ellipsis")?(b.classList.remove("y-ellipsis"),this.innerText="\u6536\u8d77"):(b.classList.add("y-ellipsis"),this.innerText="\u5c55\u5f00")});b[a].parentNode.lastChild==b[a]?b[a].parentNode.appendChild(e):b[a].parentNode.insertBefore(e,b[a].nextElementSibling)}b[a].parentNode.removeChild(c)}};a.hideKeyboard=function(){try{var b=document.querySelector("input:focus");b&&b.blur()}catch(f){}};a.share=function(b){var a={};plus.share.getServices(function(c){if(c&&0<c.length)for(var d=0;d<c.length;d++){var e=c[d];a[e.id]=e}var f=[{id:"weixin",ex:"WXSceneSession",name:"\u5fae\u4fe1"},{id:"weixin",ex:"WXSceneTimeline",name:"\u5fae\u4fe1"}];plus.nativeUI.actionSheet({cancel:"\u53d6\u6d88",buttons:[{title:"\u53d1\u9001\u7ed9\u5fae\u4fe1\u597d\u53cb"},{title:"\u5206\u4eab\u5230\u5fae\u4fe1\u670b\u53cb\u5708"}]},function(c){c=c.index;if(0==c)return!1;b.extra={scene:f[c-1].ex};if(0<c){var d=a[f[c-1].id];d.nativeClient?d.authenticated?d.send(b,function(){mui.toast('\u5206\u4eab\u5230"'+d.description+'"\u6210\u529f\uff01 ')},function(b){app.log('\u5206\u4eab\u5230"'+d.description+'"\u5931\u8d25: '+b.code+" - "+b.message)}):d.authorize(function(){d.send(b,function(){mui.toast('\u5206\u4eab\u5230"'+d.description+'"\u6210\u529f\uff01 ')},function(b){app.log('\u5206\u4eab\u5230"'+d.description+'"\u5931\u8d25: '+b.code+" - "+b.message)})},function(b){}):mui.toast("\u65e0\u6cd5\u6253\u5f00\u201c"+f[c-1].name+"\u201d")}})},function(){})};a.shareCurrentWebview=function(){var b=plus.webview.currentWebview(),c=new plus.nativeObj.Bitmap;b.draw(c,function(){c.save("_doc/img/temp/temp.jpg",{overwrite:!0},function(b){c.clear();a.share({pictures:["_doc/img/temp/temp.jpg"]})},function(b){})},function(b){})}})(app,document,window);(function(a){var e=require("mui");a.decToHex=function(a){for(var b=[],c=0;c<a.length;c++)b[c]=("00"+a.charCodeAt(c).toString(16)).slice(-4);return"\\u"+b.join("\\u")};a.pageLoaded=function(){var a=plus.webview.currentWebview();if(a.ref&&a.ref.parentPageID&&"1"!=a.ref.isFirstLoad){a.ref.isFirstLoad="1";var b=plus.webview.getWebviewById(a.ref.parentPageID);e.fire(b,a.id+"loaded",{ref:{pageid:a.id}})}};a.openPage=function(c,b,f,d,g){if(e.os.plus){var h=plus.webview.currentWebview();f=f||{};f.parentPageURL=h.getURL();f.parentPageID=h.id;var k=plus.webview.getWebviewById(b);if(k)k.ref=f,e.fire(k,"reload",{ref:f}),k.show("pop-in");else{a.showWaiting();var l=function(c){c.detail.ref.pageid==b&&(a.closeWaiting(),k.show("pop-in"),k.addEventListener(g.popGesture,function(b){e.fire(k,"unload",{popevent:b});d&&d(k)}),window.removeEventListener(b+"loaded",l))};window.addEventListener(b+"loaded",l);setTimeout(function(){a.closeWaiting()},5E3);g=g||{popGesture:"hide"};k=e.preload({id:b,url:c,styles:g,extras:{ref:f}})}}else{var h="?",m;for(m in f)h+="ref."+m+"\x3d"+f[m]+"\x26";location.href=c+h}};a.openWin=function(a,b,f,d,g){if(e.os.plus){var c=plus.webview.getWebviewById(b);c?(e.fire(c,"reload",{ref:f}),c.show("pop-in")):(g=g||{popGesture:"hide"},c=e.preload({id:b,url:a,styles:g,extras:{ref:f}}),c.show("pop-in"),d&&c.addEventListener(g.popGesture,function(){e.fire(c,"unload",{});d(c)}))}else{b="?";for(var k in f)b+="ref."+k+"\x3d"+f[k]+"\x26";location.href=a+b}};e.os.plus&&(a.isStatusbarOffset=function(){return e.os.ios&&7<=parseFloat(e.os.version)});a.getWXService=function(a){var b=void 0;plus&&plus.oauth.getServices(function(c){var d=["weixin"],e;for(e in c){var f=c[e];if(~d.indexOf(f.id)){b=f;break}}return a(b)},function(c){return a(b)})};a.loginWX=function(c,b,f){var d={};app.showWaiting(void 0,1);a.logUI(JSON.stringify(c));var g=plus.push.getClientInfo();try{d.weicode=c.userInfo.unionid,d.toke=c.authResult.refresh_token,d.nickName=c.userInfo.nickname,d.imgUrl=c.userInfo.headimgurl,d.other={push:{clientid:g.clientid,token:g.token},device:plus.device,screen:plus.screen,os:plus.os},d.other=JSON.stringify(d.other)}catch(h){a.logUI(h.toString())}a.post("api/user/LoginWeiXin",d,function(d){a.User.set(d);b&&b();e.toast("\u767b\u5f55\u6210\u529f\uff01");setTimeout(function(){app.closeWaiting()},500);a.Cache.setObject(a.Cache.key.wxService.toKeyName(),c)},function(b){a.closeWaiting();f?f():a.showError(function(){a.loginWX(c)},2)})};a.reloginWexin=function(c){a.getWXService(function(b){b?b.authResult&&b.authResult.refresh_token&&b.userInfo&&b.userInfo.unionid?(c&&c(2),e.toast("\u5df2\u7ecf\u767b\u5f55\u8ba4\u8bc1\uff01"),a.logUI("\u5df2\u7ecf\u767b\u5f55\u8ba4\u8bc1\uff01"+JSON.stringify(b)),a.loginWX(b,function(){c&&c(1)})):b.login(function(f){e.toast("\u767b\u5f55\u8ba4\u8bc1\u6210\u529f\uff01");a.logUI("\u767b\u5f55\u8ba4\u8bc1\u6210\u529f"+JSON.stringify(f.target));f.target.authResult&&f.target.authResult.refresh_token&&f.target.userInfo&&f.target.userInfo.unionid?(c&&c(2),a.loginWX(f.target,function(){c&&c(1)})):b.getUserInfo(function(d){if(d.target.authResult.refresh_token)c&&c(2),a.loginWX(d.target,function(){c&&c(1)});else if(a.logUI("refresh_token\u4e0d\u5b58\u5728"),d.target.authResult.code){a.logUI(d.target.authResult.code+"\u83b7\u53d6refresh_token");var f="https://api.weixin.qq.com/sns/oauth2/access_token?appid\x3dwxfe2987a3e834dc74\x26secret\x3d02576567e6091f5352530d0b53c0c691\x26code\x3d"+d.target.authResult.code+"\x26grant_type\x3dauthorization_code";e.ajax({url:f,type:"get",headers:{"Content-Type":"application/json"},contentType:"application/json",timeout:1E3,success:function(g){a.log(f+"\n\u8fd4\u56de\u503c\uff1a\n"+JSON.stringify(g,null,"\t"));a.logUI(f+"\n\u8fd4\u56de\u503c\uff1a\n"+JSON.stringify(g,null,"\t"));d.target.authResult.refresh_token=g.refresh_token;d.target.authResult&&d.target.authResult.refresh_token&&d.target.userInfo&&d.target.userInfo.unionid?(c&&c(2),a.loginWX(d.target,function(){c&&c(1)})):b.logout(function(b){e.toast("\u6ce8\u9500\u767b\u5f55\u8ba4\u8bc1\u6210\u529f\uff0c\u91cd\u65b0\u767b\u5f55\uff01");a.reloginWexin(c)},function(b){e.toast("\u6ce8\u9500\u767b\u5f55\u8ba4\u8bc1\u5931\u8d25\uff01");c&&c(3)})},error:function(b,d,e){c&&c(3);a.log(d);a.logUI(d)}})}else c&&c(3),e.toast("\u767b\u5f55\u6388\u6743code\u4e0d\u5b58\u5728")},function(d){e.toast("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff1a"+d.message+" - "+d.code);b.logout(function(b){a.reloginWexin(c)},function(b){c&&c(3);e.toast("\u6ce8\u9500\u767b\u5f55\u8ba4\u8bc1\u5931\u8d25\uff01")})})},function(b){c&&c(3);e.toast("\u767b\u5f55\u8ba4\u8bc1\u5931\u8d25\uff01")},{scope:"snsapi_userinfo"}):(e.toast("\u5fae\u4fe1\u767b\u5f55\u670d\u52a1\u521d\u59cb\u5316\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u5fae\u4fe1\u662f\u5426\u5b89\u88c5"),c&&c(3))})};a.AutologinWexin=function(c){var b=app.Cache.getObject(app.Cache.key.wxService.toKeyName());b&&b.authResult&&b.authResult.refresh_token&&b.userInfo&&b.userInfo.unionid?a.loginWX(b,function(){c&&c(1)},function(){a.reloginWexin(c)}):a.reloginWexin(c)};a.logUI=function(a){};a.post=function(c,b,f,d,g,h){var k=a.getUrl(c);h=h||3E3;var l=a.sign(c,b);if(0==a.User.getToken().length)return!1;var m=(new Date).getTime();a.log("\u53d1\u9001\u8bf7\u6c42"+m+"\uff1a"+k+"\n"+a.User.getToken()+"|"+JSON.stringify(l));a.logUI("\u53d1\u9001\u8bf7\u6c42"+m+"\uff1a"+k+"\n"+a.User.getToken()+"|"+JSON.stringify(l));e.ajax({url:k,type:"post",dataType:"json",headers:{"Content-Type":"application/json"},data:JSON.stringify(l),contentType:"application/json",timeout:h,crossDomain:!1,success:function(b){a.log("\n\u53d1\u9001\u6570\u636e"+m+"\uff1a"+k+"\n"+a.User.getToken()+"|"+JSON.stringify(l,null,"\t")+"\n\u8fd4\u56de\u503c\uff1a\n"+JSON.stringify(b,null,"\t"));a.logUI("\n\u53d1\u9001\u6570\u636e"+m+"\uff1a"+k+"\n"+a.User.getToken()+"|"+JSON.stringify(l,null,"\t")+"\n\u8fd4\u56de\u503c\uff1a\n"+JSON.stringify(b,null,"\t"));0==b.Code&&f(b.Data)||0<b.Code&&(e.toast(b.Message),d&&d())||-1==b.Code&&(a.User.clear(),a.Cache.set("gotab",!1),a.closeWaiting(),!!d&&d(),a.AutologinWexin())||-999>=b.Code&&(e.toast(b.Message),d&&d())},error:function(b,c,f){b="\u5931\u8d25::"+("status:"+b.status+" statusText:"+b.statusText+" responseURL:"+b.responseURL+" response:"+b.response)+"|"+c+"|"+f;app.log(b);a.logUI(b);"abort"==c?e.toast("\u8bf7\u68c0\u67e5\u7f51\u7edc!"):"timeout"==c&&e.toast("\u8fde\u63a5\u8d85\u65f6\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5!");d&&d(b)}})};a.setImage=function(c){try{var b=document.querySelector(c.selector);if(!c.reload){var e=a.Cache.get(c.key);if(e){a.log("\u672c\u5730\u7f13\u5b58\u56fe\u7247 key:"+c.key+" data:"+e);b.src=e;return}}var d=new window.XMLHttpRequest;d.responseType="blob";d.onreadystatechange=function(){if(4===d.readyState&&(200<=d.status&&300>d.status||304===d.status)){var e=new FileReader;e.onload=function(d){d=d.target.result;a.Cache.set(c.key,d);a.log("\u4e0b\u8f7d\u5e76\u7f13\u5b58 key:"+c.key+" data:"+d);b&&(b.src=d)};e.readAsDataURL(d.response)}};d.open("GET",c.url,!0);d.send()}catch(g){}};a.sign=function(c,b){var e=a.User.getToken(),d={};b.sn=a.getSN();b.uid=a.User.getUserID();""==e&&(e=a.defaultToken,a.User.setToken(e));var g=[],h;for(h in b)g.push(h);g.sort(function(b,a){return b.toLowerCase()>a.toLowerCase()?1:-1});for(h=0;h<g.length;h++){var k=g[h],l=b[k];d[k]=l;void 0!=l&&null!=l&&""!==l&&(e+=k+l)}g=require("md5");d.sign=g(e.toLowerCase());return d};a.down=function(c,b,e,d){d=d||!1;plus.io.resolveLocalFileSystemURL(b,function(b){b.remove()});var f=d&&plus.nativeUI.showWaiting("\u3000\u5f00\u59cb\u4e0b\u8f7d...\u3000",{}),h=plus.downloader.createDownload(c,{filename:b,timeout:10,retry:1},function(b,a){200==a?(f&&f.close(),e(b)):f&&f.close()}),k=0,l=0,m=function(){var b=l/k*100;f&&f.setTitle("\u3000\u5df2\u4e0b\u8f7d"+parseInt(b)+"%\u3000")},n;h.addEventListener("statechanged",function(b,c){switch(b.state){case 1:f&&f.setTitle("\u3000\u5f00\u59cb\u4e0b\u8f7d...\u3000");break;case 2:f&&f.setTitle("\u3000\u4e0b\u8f7d\u4e2d...\u3000");n=setInterval(m,500);break;case 3:k=b.totalSize;l=b.downloadedSize;break;case 4:f&&f.close(),a.log("\u4e0b\u8f7d\u6210\u529f"),clearInterval(n)}});h.start();setTimeout(function(){3>h.state&&(f&&f.close(),h.abort())},1E4)};a.iosBridge=function(c){a.log("ioscall begin");if(window.WebViewJavascriptBridge)return c(WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(c);window.WVJBCallbacks=[c];var b=document.createElement("iframe");b.style.display="none";b.src="wvjbscheme://__BRIDGE_LOADED__";document.documentElement.appendChild(b);setTimeout(function(){document.documentElement.removeChild(b)},0);a.log("ioscall end")}})(app);(function(){var a=require("vue");a.filter("f-star",function(a,c){setTimeout(function(){var b=document.querySelector("[data-starid\x3d'"+c+"']");if(b&&a){for(var e="",d=0;5>d;d++)e=a>=d+1?e+('\x3ci class\x3d"y y-wujiaoxing y-star-y y-star-h" data-index\x3d"'+(d+1)+'"\x3e\x3c/i\x3e'):a>d?e+('\x3ci class\x3d"y y-wujiaoxingo y-star-y y-star-h" data-index\x3d"'+(d+1)+'" \x3e\x3c/i\x3e'):e+('\x3ci class\x3d"y y-wujiaoxing y-star-n y-star-h"  data-index\x3d"'+(d+1)+'"\x3e\x3c/i\x3e');b.innerHTML=e}},500);return""});a.filter("f-img",function(a,c,b,f){if(a)return 0==a.indexOf("http")&&c&&(a=a?a+"?iopcmd\x3dthumbnail\x26type\x3d8\x26width\x3d"+c+"\x26height\x3d"+(b||c):a),{backgroundImage:"url("+a+")"}});a.filter("f-px",function(a){return void 0==a?a:a.replace(/(\d{1,3})px/g,function(a,b){return 1.25*parseFloat(b)+"px"})});a.filter("f-imgUrl",function(a,c,b,f){a&&c&&(a=a?a+"?iopcmd\x3dthumbnail\x26type\x3d8\x26width\x3d"+c+"\x26height\x3d"+(b||c):a);return a});a.filter("f-status",function(a,c){var b=new Date(a);c=new Date(c);var e=new Date;return e>c?"y-gray":e>b&&e<c?"y-red":"y-blue"});a.filter("f-candel",function(a){return a&&(a=a.replace("T"," ").replace("+08:00","").replace(/-/g,"/"),0<a.lastIndexOf(".")&&(a=a.substring(0,a.lastIndexOf("."))),6E5>=new Date-new Date(a))?"":"mui-hidden"});a.filter("f-time",function(a,c){a&&(a=a.replace("T"," ").replace("+08:00","").replace(/-/g,"/"),0<a.lastIndexOf(".")&&(a=a.substring(0,a.lastIndexOf("."))));if(c)result=a?a.Format(c):"";else{var b=new Date-new Date(a),e=b/2592E6,d=b/6048E5,g=b/864E5,h=b/36E5,k=b/6E4;result=1<=b/31536E6?a.Format("yyyy-MM-dd"):1<=e?parseInt(e)+"\u4e2a\u6708\u524d":1<=d?parseInt(d)+"\u5468\u524d":1<=g?parseInt(g)+"\u5929\u524d":1<=h?parseInt(h)+"\u5c0f\u65f6\u524d":1<=k?parseInt(k)+"\u5206\u949f\u524d":"\u521a\u521a"}return result})})();