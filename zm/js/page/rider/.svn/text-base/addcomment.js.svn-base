define(["app","mui","vue","mui.previewimage","mui.zoom"],function(c,e,f,g,h){new f({el:"#app",data:{data:{ShopID:void 0,Prc:void 0,NImgUrl:void 0,ClubName:void 0,ShopName:void 0,Qty:0,Tprice:"",Oid:""},par:{oid:""},user:c.User.get(),imgList:[],imgTempList:[],imgUpList:[]},computed:{},methods:{load:function(){},initpage:function(b){this.data=b;this.par.oid=this.data.Oid;c.loadImg()},addImg:function(b){var c=this,a=c.imgTempList.pop(),d="_doc/img/temp/"+(new Date).getTime()+".jpg";c.imgUpList.push(d);a={src:a,dst:d,width:"600px",height:"auto",format:"jpg",quality:70,overwrite:!0,rotate:0};if(plus.android)switch(d=a.src.replace("file://",""),d=plus.android.newObject("android.media.ExifInterface",d),plus.android.invoke(d,"getAttributeInt","Orientation",1)){case 3:a.rotate=180;break;case 8:a.rotate=270;break;case 6:a.rotate=90}plus.zip.compressImage(a,function(a){c.imgList.push({img:a.target,width:a.width,height:a.height});0<c.imgTempList.length?c.addImg(b):b&&b()})},add:function(){c.closeWaiting();e.toast("\u8bc4\u4ef7\u6210\u529f")}},ready:function(){var b=this;e.ready(function(){e.previewImage({deleteCall:function(c){b.imgList.splice(c,1);b.imgUpList.splice(c,1)}});e.os.plus||e.toast("muiReady"+c.getQueryString("ref.type"));e(".data-star").on("tap","i",function(){for(var c=parseInt(this.dataset.index),a=this.parentNode.children,b=0;5>b;b++)c>=b+1?(a[b].classList.remove("y-star-n"),a[b].classList.add("y-star-y")):(a[b].classList.remove("y-star-y"),a[b].classList.add("y-star-n"));console.log(c)})});e.plusReady(function(){e(".footer").on("tap","button",function(){c.showWaiting();var a=c.createNonceStr();b.par.guid=a;if(b.imgList.length){for(var a=plus.uploader.createUpload(c.getUrl("api/Posting/AddPostPicNew"),{method:"POST",blocksize:0,priority:10,timeout:30,retry:1,retryInterval:5},function(a,d){200==d?(b.add(),console.log("\u4e0a\u4f20\u6210\u529f: "+a.url)):(console.log("\u4e0a\u4f20\u5931\u8d25: "+d),c.closeWaiting(),e.toast("\u53d1\u8868\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u53d1\u8868"))}),d=0;d<b.imgUpList.length;d++)a.addFile(b.imgUpList[d],{key:d.toString()}),a.addData("guid",b.par.guid),a.addData("uid",c.User.getUserID());a.start()}else b.add()});document.getElementById("btnSelectImg").addEventListener("tap",function(){plus.nativeUI.actionSheet({title:"\u9009\u62e9\u56fe\u7247",cancel:"\u53d6\u6d88",buttons:[{title:"\u62cd\u7167"},{title:"\u4ece\u76f8\u518c\u9009\u62e9"}]},function(a){switch(a.index){case 1:a=plus.camera.getCamera();c.showWaiting();a.captureImage(function(a){b.imgTempList=[a];b.addImg(function(){c.closeWaiting()})},function(a){console.log(a);c.closeWaiting()},{filename:"_doc/img/temp/temp.jpg",format:a.supportedImageFormats[0],resolution:a.supportedImageResolutions[0]});break;case 2:var d=9-b.imgList.length;plus.gallery.pick(function(a){c.showWaiting();b.imgTempList=a.files.reverse().slice();b.addImg(function(){c.closeWaiting()})},function(){},{filename:"_doc/img/temp/",filter:"filter",maximum:d,multiple:!0,system:!1,onmaxed:function(){plus.nativeUI.toast("\u60a8\u6700\u591a\u53ea\u80fd\u9009\u62e9"+d+"\u5f20\u56fe\u7247")}})}})});window.addEventListener("reload",function(a){b.initpage(a.detail.ref)});window.addEventListener("unload",function(a){c.closeWaiting()});var f=plus.webview.currentWebview();b.initpage(f.ref);c.pageLoaded()})}})});