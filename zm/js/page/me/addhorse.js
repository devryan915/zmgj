define(["app","mui","vue","mui.view","jquery"],function(d,c,g,h,k){c.init({});new g({el:"#app",data:{horseData:{Name:"",Sex:"",Birth:"",Blood:"",Height:"",Color:"",HDes:"",Father:"",Mother:""},pageData:{hName:"\u5fc5\u586b",hSex:"\u5fc5\u586b",hBir:"\u5fc5\u586b",hBlood:"\u5fc5\u586b",hHeight:"\u5fc5\u586b",hHColor:"\u5fc5\u586b",hFeature:"\u5fc5\u586b",hFather:"\u9009\u586b",hMother:"\u9009\u586b",dTitle:"",dVal:"",dHint:"",hImgUrl:"../../img/horse.png",pageType:1},par:{horseId:"",val:"",infoType:0}},computed:{valid:function(){return{loginName:!!this.par.loginName,password:d.reg.password.test(this.par.password),validCode:!!this.par.validCode,remember:!!this.remember}},validCode:function(){return{isValidCode:!!this.par&&!!this.par.loginName&&this.isSendValidCode}},validPassword:function(){return{isPassword:!!this.editPasswordPar&&!!this.editPasswordPar.passwordOld&&d.reg.password.test(this.editPasswordPar.password)}},isValid:function(){var a=this.valid;return Object.keys(a).every(function(b){return a[b]})}},methods:{editSex:function(a){var b=this;b.par.infoType=10;b.par.val=a.detail.isActive?0:1;2==pageType&&d.post("api/User/UpdateHorse",b.par,function(a){},function(){b.horseData.Sex=0==b.horseData.Sex?1:0})},validVal:function(){switch(self.par.infoType){case 2:self.horseData.Name=self.pageData.dVal;break;case 3:self.horseData.Blood=self.pageData.dVal;break;case 8:self.horseData.HDes=self.pageData.dVal;break;case 9:self.horseData.Age=self.pageData.dVal;break;case 10:self.horseData.Sex=self.pageData.dVal;break;case 11:self.horseData.Color=self.pageData.dVal;break;case 12:self.horseData.Birth=self.pageData.dVal;break;case 14:self.horseData.Height=self.pageData.dVal;break;case 15:self.horseData.Father=self.pageData.dVal;break;case 16:self.horseData.Mother=self.pageData.dVal}return!1},save:function(){var a=this;a.validVal()&&(a.par.val=a.pageData.dVal,d.post("api/User/UpdateHorse",a.par,function(b){switch(a.par.infoType){case 2:a.horseData.Name=a.pageData.dVal;break;case 3:a.horseData.Blood=a.pageData.dVal;break;case 8:a.horseData.HDes=a.pageData.dVal;break;case 9:a.horseData.Age=a.pageData.dVal;break;case 10:a.horseData.Sex=a.pageData.dVal;break;case 11:a.horseData.Color=a.pageData.dVal;break;case 12:a.horseData.Birth=a.pageData.dVal;break;case 14:a.horseData.Height=a.pageData.dVal;break;case 15:a.horseData.Father=a.pageData.dVal;break;case 16:a.horseData.Mother=a.pageData.dVal}a.load();c.back()}))},getHeadClip:function(){return plus.webview.getWebviewById("whead")||c.preload({url:"head.html",id:"whead",styles:{popGesture:"hide"}})},detail:function(a){switch(a){case 1:this.pageData.dTitle="\u9a6c\u540d";this.pageData.dVal=this.horseData.Name;this.pageData.dHint="\u8bf7\u8f93\u5165\u9a6c\u540d";this.par.infoType=2;break;case 2:this.pageData.dTitle="\u6027\u522b";this.pageData.dVal=this.horseData.Sex;this.pageData.dHint="\u8bf7\u8f93\u5165\u6027\u522b";this.par.infoType=10;break;case 3:this.pageData.dTitle="\u51fa\u751f\u5e74";this.pageData.dVal=this.horseData.Birth;this.pageData.dHint="\u8bf7\u8f93\u5165\u51fa\u751f\u5e74";this.par.infoType=12;break;case 4:this.pageData.dTitle="\u8840\u7edf";this.pageData.dVal=this.horseData.Blood;this.pageData.dHint="\u8bf7\u8f93\u5165\u8840\u7edf";this.par.infoType=3;break;case 5:this.pageData.dTitle="\u4f53\u9ad8";this.pageData.dVal=this.horseData.Height;this.pageData.dHint="\u8bf7\u8f93\u5165\u4f53\u9ad8";this.par.infoType=14;break;case 6:this.pageData.dTitle="\u6bdb\u8272";this.pageData.dVal=this.horseData.Color;this.pageData.dHint="\u8bf7\u8f93\u5165\u6bdb\u8272";this.par.infoType=11;break;case 7:this.pageData.dTitle="\u7279\u5f81\u63cf\u8ff0";this.pageData.dVal=this.horseData.HDes;this.pageData.dHint="\u8bf7\u8f93\u5165\u7279\u5f81\u63cf\u8ff0";this.par.infoType=8;break;case 8:this.pageData.dTitle="\u7236\u7cfb";this.pageData.dVal=this.horseData.Father;this.pageData.dHint="\u8bf7\u8f93\u5165\u7236\u7cfb";this.par.infoType=15;break;case 9:this.pageData.dTitle="\u6bcd\u7cfb",this.pageData.dVal=this.horseData.Mother,this.pageData.dHint="\u8bf7\u8f93\u5165\u6bcd\u7cfb",this.par.infoType=16}},load:function(){this.horseData&&(this.horseData.Name&&(this.pageData.hName=this.horseData.Name),this.horseData.Sex&&(this.pageData.hSex=this.horseData.Sex),this.horseData.ImgUrl&&(this.pageData.hImgUrl=this.horseData.ImgUrl),this.horseData.Birth&&(this.pageData.hBir=this.horseData.Birth),this.horseData.Blood&&(this.pageData.hBlood=this.horseData.Blood),this.horseData.Height&&(this.pageData.hHeight=this.horseData.Height),this.horseData.Color&&(this.pageData.hHColor=this.horseData.Color),this.horseData.HDes&&(this.pageData.hFeature=this.horseData.HDes),this.horseData.Father&&(this.pageData.hFather=this.horseData.Father),this.horseData.Mother&&(this.pageData.hMother=this.horseData.Mother));d.loadImg()},changeHead:function(a){var b=this;c.os.plus&&plus.nativeUI.actionSheet({title:"\u4fee\u6539\u5934\u50cf",cancel:"\u53d6\u6d88",buttons:[{title:"\u62cd\u7167"},{title:"\u4ece\u624b\u673a\u76f8\u518c\u9009\u62e9"}]},function(c){switch(c.index){case 1:b.getImage(a);break;case 2:b.galleryImg(a)}})},initImgPreview:function(){var a=document.querySelectorAll("img.mui-action-preview");if((a=c.slice.call(a))&&0<a.length){var b=document.createElement("div");b.setAttribute("id","__mui-imageview__");b.classList.add("mui-slider");b.classList.add("mui-fullscreen");b.style.display="none";b.addEventListener("tap",function(){b.style.display="none"});b.addEventListener("touchmove",function(a){a.preventDefault()});var e=document.createElement("div");e.setAttribute("id","__mui-imageview__group");e.classList.add("mui-slider-group");a.forEach(function(a,b,c){b=document.createElement("div");b.classList.add("mui-slider-item");c=document.createElement("a");var d=document.createElement("img");d.setAttribute("src",a.src);c.appendChild(d);b.appendChild(c);e.appendChild(b)});b.appendChild(e);document.body.appendChild(b);c(b).slider()}},galleryImg:function(a){plus.gallery.pick(function(b){c.openWindow({id:"whead",url:"head.html",extras:{headUrl:b,img:a,viewID:"me_addhorse"},show:{autoShow:!0,aniShow:"slide-in-right"},waiting:{autoShow:!1}})},function(a){},{filter:"image"})},getImage:function(a){plus.camera.getCamera().captureImage(function(b){plus.io.resolveLocalFileSystemURL(b,function(b){c.openWindow({id:"whead",url:"head.html",extras:{headUrl:b.toLocalURL(),img:a,viewID:"me_addhorse"},show:{autoShow:!0,aniShow:"slide-in-right"},waiting:{autoShow:!1}})},function(a){})},function(a){},{})},defaultImg:function(){c.os.plus?plus.io.resolveLocalFileSystemURL("_doc/head.jpg",function(a){a=a.fullPath+"?version\x3d"+(new Date).getTime();document.getElementById("head-img").src=a},function(a){document.getElementById("head-img").src="../../img/horse.png"}):document.getElementById("head-img").src="../../img/horse.png"}},created:function(){},ready:function(){var a=this;window.addEventListener("editHorse",function(b){a.horseData=b.detail.horseData;a.par.horseId=a.horseData&&a.horseData.HID;a.pageData.pageType=b.detail.pageType;a.load()});var b=location.href,e=b.lastIndexOf("#"),b=-1==e?"#horseInfo":b.substring(e,b.length),f=c("#app").view({defaultPage:b});c(".mui-scroll-wrapper").scroll();c.ready(function(){var b=f.view;(function(a){var c=a.back;a.back=function(){f.canBack()?f.back():c()};b.addEventListener("pageBeforeShow",function(a){});b.addEventListener("pageShow",function(a){});b.addEventListener("pageBeforeBack",function(a){});b.addEventListener("pageBack",function(a){})})(c);c.plusReady(function(){window.addEventListener("uploadHead",function(b){d.showWaiting();d.post("api/User/UpdateHorse",{horseId:a.horseData.horseId,val:b.detail.headData,infoType:"0"},function(a){document.getElementById(b.detail.img).src=b.detail.headData;d.closeWaiting();c.toast("\u4fee\u6539\u6210\u529f")},function(){d.closeWaiting()})})})})}})});