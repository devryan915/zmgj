define(["app","mui","vue"],function(c,g,m){var h,k;c.checkLogin(function(){var e,f;new m({el:"#app",data:{par:{idx:"G1602",stage:0},rpar:{idx:"G1602",stage:0},pageData:{imgLevel:[{imgUrl:"http://chorse-sports.ufile.ucloud.com.cn/sys/rrb_1.png"},{imgUrl:"http://chorse-sports.ufile.ucloud.com.cn/sys/rrb_2.png"},{imgUrl:"http://chorse-sports.ufile.ucloud.com.cn/sys/rrb_3.png"},{imgUrl:"http://chorse-sports.ufile.ucloud.com.cn/sys/rrb_4.png"},{imgUrl:"http://chorse-sports.ufile.ucloud.com.cn/sys/rrb_5.png"},{imgUrl:"http://chorse-sports.ufile.ucloud.com.cn/sys/rrb_6.png"}],reimgLevel:[{imgUrl:"http://chorse-sports.ufile.ucloud.com.cn/sys/aab_1.png"},{imgUrl:"http://chorse-sports.ufile.ucloud.com.cn/sys/aab_2.png"},{imgUrl:"http://chorse-sports.ufile.ucloud.com.cn/sys/aab_3.png"},{imgUrl:"http://chorse-sports.ufile.ucloud.com.cn/sys/aab_4.png"},{imgUrl:"http://chorse-sports.ufile.ucloud.com.cn/sys/aab_5.png"},{imgUrl:"http://chorse-sports.ufile.ucloud.com.cn/sys/aab_6.png"}],sBTime:"",sETime:"",beginTime:null,endTime:null,curGoal:"",nGoal:"",nGoalText:"\u4e0b\u8f6e\u76ee\u6807",per:0,curStage:0,timeTitle:"\u6d3b\u52a8\u5012\u8ba1\u65f6",MyAct:[],reState:0,Confs:[]},time:{h:"00",m:"00",s:"00"}},computed:{canReceive:function(){return 1<=this.pageData.reState&&6>=this.pageData.reState}},methods:{close:function(){document.querySelector(".mui-backdrop").style.display="none"},receive:function(){var a=this;c.showWaiting();a.rpar.stage=this.pageData.reState;document.querySelector(".receive-bg").querySelector("img").src="http://chorse-sports.ufile.ucloud.com.cn/sys/rrb_mb.png";c.post("api/Lucky/LuckyActive",a.rpar,function(b){a.pageData.MyAct.push(a.pageData.reState);document.querySelector(".receive-down").innerText="\u606d\u559c\u60a8\u83b7\u5f97 "+b.LukeyItem.Qty+" \u9a6c\u5e01";a.getNextReStage();setTimeout(function(){document.querySelector(".mui-backdrop").style.display="block"},500);var d=c.User.get();d.MB+=b.LukeyItem.Qty;c.User.set(d);g.os.plus&&g.fire(plus.webview.getWebviewById("windex2"),"reload",{type:"mb"});c.closeWaiting()},function(){document.querySelector(".receive-down").innerText="\u5f88\u9057\u61be\uff0c\u9886\u53d6\u5931\u8d25";document.querySelector(".receive-bg").querySelector("img").src="http://chorse-sports.ufile.ucloud.com.cn/sys/rrb_kulian.png";setTimeout(function(){document.querySelector(".mui-backdrop").style.display="block"},500);c.closeWaiting()})},clearInval:function(){h&&clearInterval(h);k&&clearInterval(k)},load:function(){var a=this;c.showWaiting();c.post("api/Lucky/GetMyLuckyActive",a.par,function(b){a.pageData.sBTime=b.LckyItem.BeginDT.Format("yyyy.MM.dd");a.pageData.sETime=b.LckyItem.EndDT.Format("yyyy.MM.dd");a.pageData.beginTime=new Date(b.LckyItem&&Date.parse(b.LckyItem.BeginDT));a.pageData.endTime=new Date(b.LckyItem&&Date.parse(b.LckyItem.EndDT));a.pageData.MyAct=b.MyAct;a.pageData.Confs=b.Confs;a.pageData.curGoal=b.Finish.CurVal;a.getNextGoal(b.Finish.FStage);a.getNextReStage();a.pageData.per=b.Finish.Per;f=document.getElementById("rebateLevel");e=document.getElementById("rebateLevelLine");a.showState();b=document.getElementById("rebateLevelContent");var d=document.querySelector(".activity_rules");f.style.marginTop=-(f.offsetTop-rebateBg.offsetTop)+"px";f.style.paddingTop="0";e.style.marginTop=-(e.offsetTop-f.offsetTop)+"px";e.style.paddingTop="0";var l=.5*(b.offsetTop-e.offsetTop);b.style.marginTop=-(l+55)+"px";d.style.marginTop=-(150-l)+"px";a.rotateNext();a.refresh();c.closeWaiting()},function(){c.closeWaiting()})},refreshLoad:function(){var a=this;c.showWaiting();c.post("api/Lucky/GetMyLuckyActive",a.par,function(b){a.pageData.sBTime=b.LckyItem.BeginDT.Format("yyyy.MM.dd");a.pageData.sETime=b.LckyItem.EndDT.Format("yyyy.MM.dd");a.pageData.beginTime=new Date(b.LckyItem&&Date.parse(b.LckyItem.BeginDT));a.pageData.endTime=new Date(b.LckyItem&&Date.parse(b.LckyItem.EndDT));a.pageData.MyAct=b.MyAct;a.pageData.Confs=b.Confs;a.pageData.curGoal=b.Finish.CurVal;a.getNextGoal(b.Finish.FStage);a.getNextReStage();a.pageData.per=b.Finish.Per;a.rotateNext();a.refresh();c.closeWaiting()},function(){c.closeWaiting()})},showState:function(){0<this.pageData.reState?f.querySelector("img").src=this.pageData.reimgLevel[0>this.pageData.reState-1?0:5<this.pageData.reState-1?5:this.pageData.reState-1].imgUrl:f.querySelector("img").src=this.pageData.imgLevel[0>this.pageData.curStage?0:5<this.pageData.curStage?5:this.pageData.curStage].imgUrl},refresh:function(){var a=this;h=setInterval(function(){if(a.pageData.beginTime||a.pageData.endTime){var b=new Date;a.pageData.beginTime.getTime()>b.getTime()?(b=a.pageData.beginTime.getTime()-b.getTime(),a.pageData.timeTitle="\u6d3b\u52a8\u5f00\u59cb\u5012\u8ba1\u65f6"):a.pageData.beginTime.getTime()<=b.getTime()&&a.pageData.endTime.getTime()>=b.getTime()?(b=a.pageData.endTime.getTime()-b.getTime(),a.pageData.timeTitle="\u6d3b\u52a8\u7ed3\u675f\u5012\u8ba1\u65f6"):(b=0,a.pageData.timeTitle="\u6d3b\u52a8\u5df2\u7ed3\u675f",a.clearInval());var d=b%864E5;a.time.h=Math.floor(d/36E5)+24*Math.floor(b/864E5);a.time.h=1==a.time.h.toString().length?"0"+a.time.h:a.time.h;b=d%36E5;a.time.m=Math.floor(b/6E4);a.time.m=1==a.time.m.toString().length?"0"+a.time.m:a.time.m;a.time.s=Math.round(b%6E4/1E3);a.time.s=1==a.time.s.toString().length?"0"+a.time.s:a.time.s}},1E3);k=setInterval(function(){a.par.stage=a.pageData.curStage;c.post("api/Lucky/GetLuckyFinish",a.par,function(b){a.pageData.curGoal=b.CurVal;a.getNextGoal(b.FStage);a.getNextReStage();a.pageData.per=b.Per;a.showState();a.rotateNext()})},3E3)},getNextReStage:function(){if(this.pageData.MyAct){var a=0,b=0;for(j=0;j<this.pageData.MyAct.length;j++)if(this.pageData.MyAct[j]==this.pageData.curStage){b=1;break}0===b&&(a=this.pageData.curStage);this.pageData.reState!=a&&(this.pageData.reState=a)}},getNextGoal:function(a){var b="";6<=this.pageData.curStage+1&&(this.pageData.nGoalText="\u6240\u6709\u76ee\u6807\u5df2\u8fbe\u6210");if(a)for(this.pageData.curStage=a,i=0;i<this.pageData.Confs.length;i++){if(this.pageData.Confs[i].Stage==this.pageData.curStage+1){b=this.pageData.Confs[i].EndValue;break}}else for(i=this.pageData.curStage=0;i<this.pageData.Confs.length;i++)if(1==this.pageData.Confs[i].Stage){b=this.pageData.Confs[i].EndValue;break}b!=this.pageData.nGoal&&(this.pageData.nGoal=b)},rotateNext:function(){var a=0>this.pageData.curStage?0:5<this.pageData.curStage?5:this.pageData.curStage;e.style.transform="rotate("+(.6*this.pageData.per+60*a)+"deg)";e.style.webkitTransform="rotate("+(.6*this.pageData.per+60*a)+"deg)"}},ready:function(){for(var a=this,b=document.getElementsByTagName("head")[0],d,c=0;c<a.pageData.imgLevel.length;c++)d=document.createElement("link"),d.setAttribute("rel","prefetch"),d.setAttribute("href",a.pageData.imgLevel[c].imgUrl),b.appendChild(d);for(c=0;c<a.pageData.reimgLevel.length;c++)d=document.createElement("link"),d.setAttribute("rel","prefetch"),d.setAttribute("href",a.pageData.reimgLevel[c].imgUrl),b.appendChild(d);b=document.getElementById("rebateBg");b.onload=function(){a.load()};b.src="http://chorse-sports.ufile.ucloud.com.cn/sys/rrb_bg.png";g.ready(function(){g(".mui-scroll-wrapper").scroll({scrollY:!0,scrollX:!1,startX:0,startY:0,indicators:!0,deceleration:6E-4,bounce:!0})});g.plusReady(function(){window.addEventListener("reload",function(b){a.refreshLoad()});window.addEventListener("unload",function(b){a.clearInval()})})}})})});