define(["app","mui","vue","mui.pullToRefresh","mui.pullToRefresh.material"],function(e,c,l,m,n){new l({el:"#app",data:{user:e.User.get(),pageData:{isRider:!1,isTeam:!1,isHorse:!1,holder:"",keyword:""},isStrokeUp:!0,serverData:{Total:0,Items:[]},reqTeamPar:{corpsName:"",pageIndex:1,pageSize:20},reqRiderPar:{nickName:"",pageIndex:1,pageSize:12},reqHorsePar:{horseName:"",bloodType:"",pageIndex:1,pageSize:20}},computed:{},methods:{detail:function(b){b=b.dataset.id;if(this.pageData.isTeam){var a;c.plus&&(a=plus.webview.getWebviewById("match_teaminfo"));a?(c.fire(a,"teamID",{teamID:b}),c.openWindow({id:"match_teaminfo"})):c.openWindow({id:"match_teaminfo",url:"teaminfo.html",extras:{teamID:b},show:{aniShow:!1},waiting:{autoShow:!1}})}this.pageData.isRider&&(c.plus&&(a=plus.webview.getWebviewById("match_riderinfo")),a?(c.fire(a,"riderID",{riderID:b,pageType:1}),c.openWindow({id:"match_riderinfo"})):c.openWindow({id:"match_riderinfo",url:"riderinfo.html",extras:{riderID:b,pageType:1},show:{aniShow:!1},waiting:{autoShow:!1}}));this.pageData.isHorse&&(c.plus&&(a=plus.webview.getWebviewById("match_horseinfo")),a?(c.fire(a,"horseID",{horseID:b}),c.openWindow({id:"match_horseinfo"})):c.openWindow({id:"match_horseinfo",url:"horseinfo.html",extras:{horseID:b},show:{aniShow:!1},waiting:{autoShow:!1}}))},load:function(b){this.pageData.isRider=!1;this.pageData.isTeam=!1;this.pageData.isHorse=!1;switch(b){case 1:this.pageData.isRider=!1;this.pageData.isTeam=!0;this.pageData.isHorse=!1;break;case 3:this.pageData.isRider=!0;this.pageData.isTeam=!1;this.pageData.isHorse=!1;break;case 4:this.pageData.isRider=!1;this.pageData.isTeam=!1;this.pageData.isHorse=!0;break;default:return}this.pageData.isRider&&(this.pageData.holder="\u641c\u7d22\u9a91\u624b",c.init({preloadPages:[{id:"match_riderinfo",url:"riderinfo.html"}]}));this.pageData.isTeam&&(this.pageData.holder="\u641c\u7d22\u6218\u961f",c.init({preloadPages:[{id:"match_teaminfo",url:"teaminfo.html"}]}));this.pageData.isHorse&&(this.pageData.holder="\u641c\u7d22\u9a6c\u5339",c.init({preloadPages:[{id:"match_horseinfo",url:"horseinfo.html"}]}))},loadData:function(b){var a=this,d,f;a.pageData.isTeam&&(c("#teams").on("tap","li",function(){a.detail(this)}),b||(a.reqTeamPar.pageIndex=1,a.serverData.Total=1,a.isStrokeUp=!0,a.serverData.Items=[]),a.reqTeamPar.corpsName=a.pageData.keyword,f="api/Events/GetCorpsList",d=a.reqTeamPar);a.pageData.isRider&&(c("#riders").on("tap","li",function(){a.detail(this)}),b||(a.reqRiderPar.pageIndex=1,a.serverData.Total=1,a.isStrokeUp=!0,a.serverData.Items=[]),a.reqRiderPar.nickName=a.pageData.keyword,f="api/Events/GetRiderList",d=a.reqRiderPar);a.pageData.isHorse&&(c("#horses").on("tap","li",function(){a.detail(this)}),b||(a.reqHorsePar.pageIndex=1,a.serverData.Total=1,a.isStrokeUp=!0,a.serverData.Items=[]),a.reqHorsePar.horseName=a.pageData.keyword,a.reqHorsePar.bloodType="All",f="api/Events/GetHorseList",d=a.reqHorsePar);var k=document.querySelector("#prMatch .mui-pull-loading"),h=a.pageData.isHorse?Math.ceil(1*a.serverData.Total/a.reqHorsePar.pageSize):a.serverData.Total,g=d.pageIndex==h;d.pageIndex<=a.serverData.Total?e.post(f,d,function(c){a.serverData.Total=c.Total;h=a.pageData.isHorse?Math.ceil(1*a.serverData.Total/a.reqHorsePar.pageSize):a.serverData.Total;g=d.pageIndex==h;d.pageIndex++;a.isStrokeUp?(a.serverData.Items=a.serverData.Items.concat(c.Items),b&&b.endPullUpToRefresh()):(a.serverData.Items=c.Items,b.endPullDownToRefresh(),b.refresh(!0));b?b.endPullUpToRefresh(g):g&&(k.innerHTML=a.serverData.Items&&0<a.serverData.Items.length?"\u5df2\u52a0\u8f7d\u5168\u90e8":'\x3ci class\x3d"y y-jilu"\x3e\x3c/i\x3e\x3cspan\x3e\u6682\u65e0\u6570\u636e\x3c/span\x3e');e.loadImg();e.closeWaiting()},function(){b&&(b.endPullDownToRefresh(),b.endPullUpToRefresh())}):(b&&b.endPullUpToRefresh(g),k.innerHTML=a.serverData.Items&&0<a.serverData.Items.length?"\u5df2\u52a0\u8f7d\u5168\u90e8":'\x3ci class\x3d"y y-jilu"\x3e\x3c/i\x3e\x3cspan\x3e\u6682\u65e0\u6570\u636e\x3c/span\x3e')},search:function(b){(this.pageData.isTeam||this.pageData.isRider||this.pageData.isHorse)&&b&&(this.pageData.keyword=b.target.value,this.loadData())}},ready:function(){var b=this;c.ready(function(){c(".mui-scroll-wrapper").scroll({scrollY:!0,scrollX:!1,startX:0,startY:0,indicators:!0,deceleration:6E-4,bounce:!0});c("#prMatch").pullToRefresh({down:{callback:function(){if(b.pageData.isTeam||b.pageData.isRider||b.pageData.isHorse)b.pageData.isTeam&&(b.reqTeamPar.pageIndex=1),b.pageData.isRider&&(b.reqRiderPar.pageIndex=1),b.pageData.isHorse&&(b.reqHorsePar.pageIndex=1),b.serverData.Total=1,b.isStrokeUp=!1,b.loadData(this)}},up:{contentnomore:"\u5df2\u52a0\u8f7d\u5168\u90e8",callback:function(){if(b.pageData.isTeam||b.pageData.isRider||b.pageData.isHorse)b.isStrokeUp=!0,b.loadData(this)}}});window.addEventListener("pageID",function(a){b.load(a.detail.pageID)})});c.plusReady(function(){var a=plus.webview.currentWebview();a&&a.pageID&&b.load(a.pageID)})}})});