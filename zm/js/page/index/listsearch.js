//此页面预加载
define(["app","mui","vue","mui.pullToRefresh","mui.pullToRefresh.material"],function(d,c,h,k,l){var f=document.querySelector("input[type\x3dsearch]"),g;new h({el:"#app",data:{pageData:{type:-1},serverData:{Count:0,NewItem:null,UID:1,LID:-1,Items:[]},reqPar:{idx:-1,newsType:-1,isNeedNew:"false",search:"",pageSize:5},ptr:null,urlStr:"api/News/GetNewsPageV2"},computed:{},methods:{detail:function(b){var a=plus.webview.getWebviewById("wnews_detail");a?(c.fire(a,"reload",{ref:{id:b.dataset.id,title:b.dataset.title}}),a.show("slide-in-right")):(a=c.preload({url:"../news/detail.html",id:"wnews_detail",styles:{popGesture:"hide"},extras:{ref:{id:b.dataset.id,title:b.dataset.title}}}),a.show("slide-in-right"),a.addEventListener("hide",function(){c.fire(a,"unload",{})}))},search:function(){this.serverData.LID=-1;this.reqPar.idx=-1;this.serverData.Items=[];this.ptr&&this.ptr.refresh(!0);this.pullupRefresh()},resetData:function(){this.serverData.LID=-1;this.reqPar.idx=-1;this.reqPar.search="";this.serverData.Items=[];this.ptr&&this.ptr.refresh(!0)},pullupRefresh:function(){var b=this;if(b.reqPar.search&&0<b.reqPar.search.trim().length&&0<=b.pageData.type){var a=-1<b.serverData.LID;d.showWaiting(1);d.post(b.urlStr,b.reqPar,function(c){b.serverData.Count=c.Count;"true"==b.reqPar.isNeedNew&&((b.serverData.NewItem=c.NewItem)||(b.reqPar.isNeedNew="false"));b.serverData.UID=c.UID;b.serverData.LID=c.LID;a=-1<b.serverData.LID;b.serverData.Items=b.serverData.Items.concat(c.Items);b.ptr.endPullUpToRefresh(!a);d.loadImg();d.closeWaiting()},function(){b.ptr.endPullUpToRefresh(!a);d.closeWaiting()})}},loadData:function(b){var a=this,c=-1<a.serverData.LID;c||!c&&!b?d.post(a.urlStr,a.reqPar,function(e){a.serverData.Count=e.Count;"true"==a.reqPar.isNeedNew&&(a.serverData.NewItem=e.NewItem);a.serverData.UID=e.UID;a.serverData.LID=e.LID;c=-1<a.serverData.LID;b?(a.serverData.Items=a.serverData.Items.concat(e.Items),a.ptr.endPullUpToRefresh(!c)):(a.serverData.Items=e.Items,a.ptr.endPullDownToRefresh(),a.ptr.refresh(!0));d.loadImg()},function(){b?a.ptr.endPullUpToRefresh(!c)||d.log("\u4e0a\u62c9\u53d1\u751f\u5f02\u5e38"):a.ptr.endPullDownToRefresh()||d.log("\u4e0b\u62c9\u53d1\u751f\u5f02\u5e38")}):a.ptr.endPullUpToRefresh(!c)},init:function(b){var a=this;a.pageData.type=b;a.ptr.endPullUpToRefresh(!0);b=document.querySelector(".header-search .mui-placeholder span:last-child");switch(a.pageData.type){case 0:document.getElementById("mem").classList.remove("mui-hidden");a.reqPar.newsType=9;c(".mem-main-mem").on("tap",".mem-item-mem",function(){a.detail(this)});b&&(b.innerHTML="\u4f1a\u5458\u540d\u79f0");break;case 1:document.getElementById("club").classList.remove("mui-hidden");a.reqPar.newsType=8;c(".mui-scroll").on("tap",".mem-item-club",function(){a.detail(this)});b&&(b.innerHTML="\u4ff1\u4e50\u90e8\u540d\u79f0");break;case 2:document.getElementById("news").classList.remove("mui-hidden");a.reqPar.newsType=1;c(".mui-scroll").on("tap",".mem-item-news",function(){a.detail(this)});b&&(b.innerHTML="\u65b0\u95fb");break;case 3:document.getElementById("hs").classList.remove("mui-hidden"),a.reqPar.newsType=10,c(".mui-scroll").on("tap",".mem-item-hs",function(){a.detail(this)}),b&&(b.innerHTML="\u9a6c\u672f\u8bb2\u5802")}}},ready:function(){var b=this;window.addEventListener("pageType",function(a){b.init(a.detail.pageType);c.os.plus&&plus.webview.currentWebview().show("slide-in-right")});c.ready(function(){var a=c.back;c.back=function(){b.resetData();switch(b.pageData.type){case 0:document.getElementById("mem").classList.add("mui-hidden");break;case 1:document.getElementById("club").classList.add("mui-hidden");break;case 2:document.getElementById("news").classList.add("mui-hidden");break;case 3:document.getElementById("hs").classList.add("mui-hidden")}a()};f&&f.focus();var d=c.os.ios?.003:9E-4;c(".mui-scroll-wrapper").scroll({bounce:!0,indicators:!0,deceleration:d});b.ptr=c(".mui-scroll").pullToRefresh({up:{auto:!1,offset:100,show:!0,contentdown:"\u4e0a\u62c9\u663e\u793a\u66f4\u591a",contentrefresh:"\u6b63\u5728\u52a0\u8f7d...",contentnomore:"\u6ca1\u6709\u66f4\u591a\u6570\u636e\u4e86",callback:function(){b.reqPar.idx=b.serverData.LID;b.pullupRefresh()}}})});c.plusReady(function(){g=function(){if(c.os.ios)plus.webview.currentWebview().nativeInstanceObject().plusCallMethod({setKeyboardDisplayRequiresUserAction:!1});else{var a=plus.android.currentWebview();plus.android.importClass(a);a.requestFocus();var a=plus.android.importClass("android.content.Context"),b=plus.android.importClass("android.view.inputmethod.InputMethodManager");plus.android.runtimeMainActivity().getSystemService(a.INPUT_METHOD_SERVICE).toggleSoftInput(0,b.SHOW_FORCED)}};plus.webview.currentWebview().addEventListener("hide",function(a){f.value="";f.blur()});plus.webview.currentWebview().addEventListener("show",function(a){setTimeout(function(){f.focus();g()},300)})})}})});